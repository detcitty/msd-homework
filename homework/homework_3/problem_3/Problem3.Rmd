---
title: "Problem3"
author: "Devin Etcitty"
date: "4/25/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(ggplot2)
library(tidyverse)
library(scales)
library(igraph)
library(plyr)
```

#### Read in undweighted10.dat
First, read in the edge list for 2010 from the undweighted10.dat file

```{r}
setwd("~/columbia/APMA4990/msd-homework/homework/homework_3/problem_3")
year2010 <- read.delim("undweighted10.dat", header = FALSE, sep = ' ')
colnames(year2010) <- c('userID1', 'userID2', 'num_email')

```


Make a plot of the distribution of edge weights for the entire network
Use a log-log scale and comment on the result. What does it tell you about the distribution of tie strength?

```{r}
count_df <- year2010 %>% 
  count(num_email)

count_df

```

# Graph

```{r}
ggplot(count_df, aes(x=num_email, y =n)) +
  geom_point() +
  scale_x_log10() +
  scale_y_log10()


```


```{r}
ggplot(count_df, aes(x=n, y =num_email)) +
  geom_point() +
  scale_x_log10() +
  scale_y_log10()

```


```{r}
ggplot(count_df, aes(x=num_email, y=n)) +
  geom_jitter() +
  scale_x_log10(name = "Number of Emails Sent", labels=comma) +
  scale_y_log10(name = "Number of People", labels=comma) 
```


```{r}
power2 <- 2^(0:10)
power2 <- append(power2, 0, 0)
power2
```


for(threshold in power2) {
  filter(year2010, num_email > threshold) %>%
    count() %>%
    print()
  
}

```{r}
filter(year2010, num_email > power2) %>% count()
#ddply(year2010, )


mod_func <- function(arr, df) {   
  filter(df, num_email > x) %>%
    count()
  data.frame(num_nodes = countnodes)
}

adply(power2, mod_func, df=year2010)


year2010 %>% 
  rowwise() %>%
  mutate(var = 1)
#ddply(year2010, 2, add_column)
```

